% Chapter Template

\chapter{Introduction} % Main chapter title

\label{chapter:intro} 

\section{Motivation and Research Question}\label{chap1:motiv}

The world has witnessed an endless gallery of video games, which engage a large broad audience of committed players. The industry has also grown to a multi-billion dollar industry in the past few years. The \textit{Super Mario Bros.}  (Nintendo Co. Ltd) franchise, for example, sold over 160 million copies since the 1980s \citep{mariosale}. In the summer of 2016, \textit{Pok\'{e}mon Go} (Niantic, Inc.) swept the globe with more than 500 million downloads~\citep{pokemongo}, triggering the crowd to walk on the street as part of the game. Recently, there has been a rise in competitive team-based player-vs-player games, which engage millions of players. As an example, \textit{League of Legends}, a 5-vs-5 online competitive game, engaged 90 million registered users, 27 million unique daily players and 7.5 million concurrent users at peak \citep{lol_fanbase,lol_27million}. The game is characterized by mechanics that engage players in both competition and collaboration as well as problem solving and strategy formation and execution. 

At the same time, the viewership of video games has also grown rapidly. E-Sports, a subset of highly competitive video games, was estimated to have hundreds of millions of viewers in 2017. This number is projected to grow at a rate of 12\% each year~\citep{superdata2017}. There are now internet-based channels like \textit{Twitch.tv}, which was developed to specifically show videos of gameplays with commentators discussing gameplay strategies, just like other sports events~\citep{superdata2017stream}.  

Besides entertainment, video games have also been utilized for various purposes, such as promoting aesthetic appreciation~\citep{jarvinen2008understanding}, health awareness~\citep{shiyko2016effects}, scientific problem solving~\citep{cooper2010predicting}, education~\citep{gee2003video}, and socialization~\citep{ferguson2013friends}. A salient example is Foldit~\citep{cooper2010predicting}, a multiplayer online game that engages non-scientists in solving the protein structure prediction problem, which remains largely unsolved by computational approaches. An increasing number of empirical studies also support the role of video games in fostering mental health~\citep{jones2014gaming}. For instance, some studies show that moderate video game playing helps reduce emotional disturbances in children~\citep{hull2009computer} and relieve stress among adolescents~\citep{colwell2007needs}. More interestingly, researchers have also argued that video games can encourage players to adopt healthier physical life~\citep{shiyko2016effects}. 

Additionally, physiological experiments around visual attention and abilities have shown that expert video game players tend to have higher visual abilities than others~\citep{green2003action,li2009enhancing}. This suggests that video game playing may even become a helpful complement to traditional eye-correction techniques that are used in the clinic to improve eyesight~\citep{li2009enhancing}.

As video games continue to be used as a vehicle for many societal benefits, one question arises naturally: \textit{how can we keep players engaged to reap the benefits of such experiences?} Here, I adopt the most straightforward definition of player engagement as the "continued desire" to play a game repeatedly during one session or over a longer period of time~\citep{schoenau2011player}. Indeed, poor engagement would not only hurt players' experience, but also hinders the potential of the use of  games as tools to promote societal benefits. We want to note here that this goal also has a disadvantage and ethical implication. For example, we do not want to encourage addiction or foster such a goal for this work, thus the application of the systems developed here need to be done with care and thought. We will discuss this further in the discussion about applications within Section~\ref{sec:ethical}.  

% \hl{I feel we should throw our main idea here, instead of going on introducing player engagement}

While there exist many kinds of video games, in this dissertation, I studied player engagement in \textit{match-based video games}~\citep{guo2012analysis}, an interesting test bed with rich multi-player strategies and interactions. In such games, multiple players, often random online players, compete for a defined victory goal in small sessions called matches, each spanning a few minutes to hours. Matches are independent from each other, in the sense that in-game elements~\citep{ralph2015toward,fullerton2008game}, which can range from game artifacts (e.g., levels, maps, and weapons) to players or opponents, get refreshed at the beginning of each match so that every participant starts from a relatively similar state. A simple example is online \textit{Chess} matches; at the beginning of each match, the board gets refreshed and a new opponent might be paired. Match-based video games also imply there are multiple players involved, some could be computer-controlled. Match-based video games represent a wide range of genres and titles, ranging from one-vs-one online board games like \textit{Chess} to team-based games like \textit{League of Legends} (Riot Games) and \textit{DOTA 2} (Valve Corporation), where players need to collaborate. Therefore, match-based video games arguably have more variety in player interactions and strategies than single-player games such as \textit{Tetris}. 

Since players directly interact with in-game elements, \textbf{my dissertation is grounded on an assumption that controlling what in-game elements to present to them could influence the way they play, their subjective experience of playing the game, and eventually their engagement}. To this end, I propose to use techniques of recommendation systems~\citep{medler2011using} for improving player engagement. These recommendation systems act as information filtering systems for suggesting to players in-game elements among a variety of choices  often offered in modern video games, such as which characters to play as, which items to equip with, or which opponents to play against. Following my assumption, recommendation systems could increase the likelihood of players favoring the recommended in-game elements that are predicted to affect player engagement positively thus players can enjoy better engagement in expectation. 

While there are other equally valid methods for influencing player engagement, such as manual game design and Procedural Content Generation (PCG)~\citep{yannakakis2011experience,togelius2011search}, which uses algorithms to generate game content with limited or indirect user input and will be discuss more in Section~\ref{sec:pcg}, I concentrated on in-game element recommendations for several reasons. First, recommendation systems as an algorithmic approach can be deployed in a scalable, just-in-time, and on-demand fashion, alleviating the enormous cost and effort associated with manual design. Second, studying other methods may require additional data and software tools which I do not have access to; for example, studying PCG may require permission to modify game content in existing games that are not available to me. Third, research work on in-game element recommendations, which I will overview in Section~\ref{sec:recsys}, is still scarce, presenting an opportunity to explore this topic more. 

Recommendation systems can be applied at many different points in a match-based video game, such as \textit{pre-match stage} and \textit{mid-match stage}. In this dissertation, I focused on recommendation systems applied in the \textit{pre-match} stage, the time window from the moment a player requests to start a match until the match officially begins. Depending on the nature of the game, there are various in-game elements to be determined before the match can officially start, such as opponents, characters to be played throughout the match, and starting items to bring into the match. The in-match stage period is when the real match takes place and players engage in competition. I chose to focus on the \textit{the pre-match stage} because it is the initial, yet fundamental, gateway into the main experience of the match. Bad determination of in-game elements in the pre-match stage may jeopardize player engagement from the beginning of the match and could lead to toxic behaviors such as quitting the match early~\citep{shores2014identification} and cyberbullying~\citep{kwak2015exploring}. 

Given this scope, I define the following fundamental research question for my dissertation:

% \begin{equation}
%   \tag{Main Research Question}\label{rq}
%   \parbox{\dimexpr\linewidth-4em}{%
%     \strut
%     How can we design in-game element recommendation systems working in the pre-match stage, which can improve player engagement in match-based video games?
%     \strut
%   }
% \end{equation}

\begin{displayquote}
How can we design in-game element recommendation systems working in the pre-match stage, which can improve player engagement in match-based video games?
\end{displayquote}


Under the umbrella of this fundamental research question, I further proposed two research sub-questions. The first research sub-question takes an indirect approach to improve player engagement by recommending \textit{winning-effective in-game elements} to players, where I define winning-effective in-game elements as those could boost players' winning chances if selected. 

Recommending winning-effective in-game elements for improving player engagement is mostly inspired by two theoretical foundations. The first theory is Self Determination Theory (SDT) ~\citep{ryan2006motivational,przybylski2010motivational,yee2006motivations,wu2010falling,sherry2006video,lazzaro2004we,schoenau2011player}. The reason I adopted this theory is due to the extension of this work by \textcite{przybylski2010motivational} and \textcite{ryan2006motivational}, showing the influence of the theory and its use to explain sustained engagement defined as the tendency to be in the game longer or to return to the game when offered the choice. SDT is concerned with intrinsic and extrinsic motivational factors. The early focus of SDT is on intrinsic motivation, which is the innate desire to satisfy psychological needs beyond external rewards or goals, such as money. The three psychological motivational factors the theory defines are: \textit{competence} (the need for challenge and the feeling of being capable and effective), \textit{autonomy} (the sense of volition or willingness when doing a task), and \textit{relatedness} (the feel of being connected with others). 

Another important theoretical foundation that influenced my first research sub-question is the study of Flow ~\citep{flow1990psychology}, a theory concerned about optimal experience. Flow is a state that refers to an optimal mental state of engagement where people get fully immersed, concentrated, and enjoyed in their activities and lose track of time~\citep{flow1990psychology}. Csikszentmihalyi studied people as they get into this state since mid-1970s. He was interested in discovering factors that explain why people immerse in their tasks. \textcite{sweetser2005gameflow} adapted this theory to video games and identified several factors affecting players getting into this state, specifically a balance between skill and challenge, which aligns with the construct of competence from SDT~\citep{ryan2000self}. 

Both Flow and SDT show that engagement, as I define it, can be achieved through increasing competence. In reality, not all players are competent enough to maintain optimal player engagement. One cause of incompetence that several studies have shown is the challenge of making winning-effective choices of in-game elements, such as what character/items to select for best fitting a combat~\citep{looi2018recommender,summerville2017reco,hanke2017reco}, as modern video games with rich design often offer several choices of in-game elements which may overwhelm players. Our rationale is to use recommendation systems to filter winning-effective in-game elements efficiently from a large number of candidates and then present the recommendations to players. We assume if incompetent players adopt our recommendations, their chance of victory will be improved, which will consequently lead to better game outcomes
and improved competence, thus will finally lead to better engagement as theories suggest.  

% This is based on the assumption that presenting winning-effective in-game elements to players could improve their competence, and subsequently their engagement. 

It is important to note that, in this dissertation, I focused on the recommendation techniques for \textit{searching} winning-effective in-game elements, but I did not specifically evaluate the resulting change in player competence or engagement due to the use of the recommendation. Neither did I investigate how such recommendation should also  avoid let players become under-challenged. These will be explored further in future research.


Furthermore, considering that there are one-vs-one and team-vs-team games, I would like to study the two settings separately because the latter setting has more complexity in the sense that the strategies by multiple players might simultaneously influence the strategy to identify winning-effective in-game elements for the player themselves. 


In summary, I formalize my first research sub-question as: 
\begin{equation}
  \tag{R.S.Q. 1}\label{rq1}
  \parbox{\dimexpr\linewidth-4em}{%
    \strut
    How can we design systems working in the pre-match stage that can recommend winning-effective in-game elements, within the settings of one-vs-one and team-vs-team?
    \strut
  }
\end{equation}



 

% It should be noted that the approach proposed here can be seen as an \textit{indirect} approach to improve player engagement due to the intermediate links between winning-effectiveness and player competence, and between player competence and engagement. 


% also indicates that the optimality of player engagement comes from challenges which match the player's skill level and keep at an appropriate pace. 

% they are an \textit{indirect} means to improve player engagement due to the intermediate links between winning-effectiveness and player competence, and between player competence and engagement. In the second research sub-question

While recommendation systems  focusing on improving  winning-effectiveness are grounded by theories like SDT and Flow, I also want to study how in-game element recommendations can be used directly to improve player engagement using data-driven approaches.

Data-driven approaches determine recommendations purely based on analysis and interpretation from past player data, without the need to rely on psychological and sociological theories as in \hyperref[rq1]{\textbf{R.S.Q.~1}}. Data-driven approaches often use machine learning models to establish numerical links between players' historical data and profiles to engagement metrics~\citep{yannakakis2013player}. Engagement metrics can be seen as proxies for engagement which could be quantitatively calculated from past data without the need to conduct particular experiments to measure cognitive states or subjects' interest, thoughts or emotions. Empirical studies have examined proxies for engagement such as: purchases in the game~\citep{xie2015predicting,sifa2015predicting}, the number of matches played within a time window~\citep{xue2017dynamic,weber2011modeling,}, or churn risk~\citep{hadiji2014predicting,harrison2012players}, where churn risk is a conventional name defined as the likelihood of a player to discontinue play or quit the game. 

Bypassing the intermediate links between winning-effectiveness and player competence, and between player competence and engagement, the main idea of recommending in-game elements for directly improving player engagement is to determine an engagement metric and efficiently search for the in-game element that achieves the optimal value of that engagement metric. This means the recommendation system should be able to predict the change in the engagement metric resulting from each in-game element.  

In summary, my second research sub-question is formalized as:
\begin{equation}
  \tag{R.S.Q. 2}\label{rq2}
  \parbox{\dimexpr\linewidth-4em}{%
    \strut
    How can we design systems working in the pre-match stage which recommend in-game elements for improving player engagement through data-driven approaches?
    \strut
  }
\end{equation}

% 
% Such a system is more complicated than what I study in \hyperref[rq1]{\textbf{R.S.Q.~1}}, because the system needs to predict both the change of in-game dynamics an in-game element to suggest that would increase and player engagement resulting from that, while \hyperref[rq1]{\textbf{R.S.Q.~1}} is mainly concerned with in-game elements that have a probability of giving a player a winning edge. 



% \hl{I feel there is no need to have that churn risk example in introduction}
% Here, I use an empirical example drawn from real-world data to evidence the close relationship between player competence and player engagement. The data is from a popular player-versus-player game title published by Electronic Arts, Inc. The game is played match by match, with each having one of three possible outcomes - win, lose or draw. In Table~\ref{tab:churnrate}, I show that 7-day churn risks vary drastically upon players' recent game outcomes in the game, where 7-day churn risk is the ratio of the players who stop playing within a week after a match. What I discover are that: (1) monotonous losses result in the worst churn rate (5.1\%), which can be related to lack of competence due to insufficient capabilities; (2) more interestingly, monotonous wins is not the best game outcome sequence; rather, the lowest churn rate is mostly realized when the last three game outcomes show progress on player competence - e.g., no win in the first two matches and finally a win in the third match. The results demonstrate that being constantly under- or over-competent blemish player engagement and raise the importance of carefully maintaining appropriate in-game competence for players.               

% \begin{table}
% \centering
% \caption{
% Average churn risks vary drastically upon players' recent three match outcomes (\emph{(W)in}, \emph{(L)ose} or \emph{(D)raw}). Data is from a popular PvP game made by Electronic Arts, Inc. Churn risk is measured by the ratio of the players who stop playing within a period time (7 days in this table) after a match. The churn risk of some states with repeated losses (5.1\%) is almost twice as much as those of other "safer" states (2.6\%-2.7\%).
% } \label{tab:churnrate}
% \vspace{2mm}
% \begin{tabular}{|c|c|}
% \hline
% Last 3 Outcomes & Churn Risk                      \\ \hline
% DLW $|$ LLW $|$ LDW $|$ DDD      &  2.6\% - 2.7\%        \\
% ... & ...  \\
% WWW   &  3.7\% \\
% ... & ... \\
% DLL $|$ LWL $|$ LDL  &  4.6\% - 4.7\%  \\
% WWL & 4.9\% \\
% LLL & 5.1\% \\
% \hline
% \end{tabular}
% \end{table}



In seeking the answers for \hyperref[rq1]{\textbf{R.S.Q.~1}} and \hyperref[rq2]{\textbf{R.S.Q.~2}}, my dissertation outlines three recommendation systems, with each system tackling a research question and dealing with a specific type of in-game element, namely starting items, characters, and opponents. The overall contribution of my dissertation is the enrichment of arsenal of recommendation techniques that recommend  pre-match in-game elements which are either winning-effective or positively influential in player engagement measured quantitatively.

In the following section, I will briefly overview each recommendation system. Although this dissertation covers my own work, I cannot complete much of the research without collaborations with other researchers appearing in~\cite{chenqdeckrec,chen2018draft,chen2017eomm}. I will therefore shift the narrative point-of-view from "I" to the academic form of “we” in the rest of this dissertation.


\section{Dissertation Overview}\label{sec:thesis_overview}

\subsection{Starting Item Recommendation in One-vs-One}\label{sec:thesis_overview:item_recom}

We first attempt to answer \hyperref[rq1]{\textbf{R.S.Q. 1}} in the setting of one-vs-one match-based video games. We chose to study winning-effective starting item recommendation in one-vs-one \textit{Collectible Card Games} (CCGs). CCG is a popular genre within match-based video games; digital CCGs like \textit{Hearthstone} reached a record of 40 million registered accounts in 2016~\citep{hearthstonepopular}. In CCGs, the pre-match in-game items required to be selected by players is a \textit{deck}, a fixed number of cards (usually just a few dozens) that every player is asked to select from a pool of cards (usually a few hundreds) before a match starts. Decks have an important impact on player competence because in-match capabilities and strategies could largely depend on the choice of the starting items. Ideally, a winning-effective deck should contain cards which have effective synergy with each other and opposition against the cards in the opponent's deck. 

CCGs feature the challenge that the number of possible deck choices is exponentially large which makes searching for winning-effective decks efficiently a difficult problem. For example, in the particular game we study, which we will detail in Chapter~\ref{chapter:qdeckrec}, the number of all possible decks is around $1.4 \times 10^{25}$. 

To recommend winning-effective decks, we formalized the problem of searching winning-optimal decks as a combinatorial optimization problem (COP) and proposed a deck recommendation system that could approximately, but efficiently, solve the COP. The deck recommendation system proposed an efficient solution this problem~\citep{chenqdeckrec}. It first extracts a deck building policy from simulation-based deck evaluations in a training phase. The policy encodes synergistic and oppositional relationships among cards into a parameterized machine learning model, which is then used to construct a winning-effective deck based on any given input opponent stereotype in the future. The algorithm developed is cheap enough for the proposed system to be deployed for large-scale or real-time application, e.g., an online CCG's backend for recommending winning-effective decks to a population of online players. We conducted experiments to show that after the training phase, the proposed deck recommendation system is able to build highly winning-effective decks with efficient use of CPU time, which is not achievable by other existing solutions. 



\subsection{Character Recommendation in Team-vs-Team}\label{sec:thesis_overview:character_recom}

To further the work discussed above towards addressing \hyperref[rq1]{\textbf{R.S.Q. 1}} mentioned above, we chose to study winning-effective character recommendation in a different setting, specifically team-based game genre, Multi-Player Online Battle Arena (MOBA). MOBA has been one of the most popular e-sports game types~\citep{superdata2016}. In a MOBA match, two teams, composed of 5 players each, combat in a virtual environment; each player controls a character to co-operate with other teammates in attacking opponents' characters, armies, and structures, while defending their own in-game properties. In most popular MOBA games like \textit{League of Legends} and \textit{DOTA 2}, there are possibly more than 100 characters that can be picked by a player at the pre-match selection phase. As estimated by~\textcite{hanke2017reco}, the number of total possible team compositions (10 characters in a match) is approximately $1.56 \times 10^{16}$. What increases the difficulty of winning-effective character recommendation is the order of character selection: the two teams alternate to pick characters in a certain order (varied upon specific match modes) until every player gets one character selected. In order to pick a winning-effective character, a player not only needs to know complicated synergistic and oppositional relationships among characters, but should also well predict what characters will be selected by other players and how they will affect his choice. 

Like the previous approach described above, we first formally defined the problem of identifying the winning-optimal character and then proposed a system that can search for winning-effective (approximately winning-optimal) characters. To this end, we viewed the character selection phase between two teams as a \textit{combinatorial game}~\citep{browne2012survey}. Under this problem formulation, the winning-optimal character for a player is the one that leads to a character line-up with the largest predicted win rate on its team, assuming that both teams behave optimally in the character selection phase. We proposed a character recommendation system that efficiently identifies the approximated winning-optimal character for team victory while considering the character selection strategies adopted by other players ~\citep{chen2018draft}. The proposed system utilizes a type of efficient search algorithm called Monte Carlo Tree Search (MCTS)~\citep{coulom2006efficient}, which could estimate the \textit{long-term value} of each character candidate through efficiently simulating possible following character selections. We conducted empirical simulation experiments, demonstrating the proposed system's superior capability of recommending winning-effective characters over other baseline and state-of-the-arts strategies. 

\subsection{Matchmaking for Optimizing Overall Engagement}\label{sec:thesis_overview:oppo_recom}

To answer \hyperref[rq2]{\textbf{R.S.Q.~2}}, we chose to study the opponent recommendation problem, better-known as matchmaking~\citep{medler2011using}, in which the goal is to connect and divide a population of online players into individual matches. In this problem, players themselves are the subject of recommendations. Using a data-driven approach, we designed a matchmaking framework which determines the recommended opponent(s) for each player such that their resulting match outcomes would expectedly result in the optimal value of a chosen player engagement metric. 

A common strategy of current practical matchmaking systems is creating fair matches, that is, to create matches where they team up players who have similar skills and where match outcomes are hard to predict apriori. This strategy is inspired by the theoretical work we discussed above, such as Flow and SDT, where optimal engagement is achieved through a balance between challenge and frustration~\citep{sweetser2005gameflow,flow1990psychology,chen2007flow,graepel2006ranking}. The strategy essentially uses only one dimension of personal information - player skill and do not link the opponent recommendation to quantitative measurement of player engagement. 

However, always creating fairly-skilled matches may not be optimal to all types of players at all times in terms of specific engagement metrics. Let us consider a widely used engagement metric, churn risk, which is the likelihood of one player stopping playing the game. Consider a cautious player who cares about protecting his rank among friends, and a risk taker who enjoys difficult matches. Pairing them with the similarly skilled opponents will affect these players' churn risks very differently. Even for the same player, their churn risk after the coming match when they just lost three games in a row can be very different from that when they recently performed well. 

We hypothesized that a more dedicated matchmaking strategy is needed to cater individuals' dynamic desire for optimal engagement. We, therefore, proposed a matchmaking system which can model players with richer states besides skill, and instead of always creating matches with similarly skilled players, the recommended opponents are predicted to result in following matches \textit{optimal} for player engagement, which is measured by a data-driven approach over the  player population~\citep{chen2017eomm}. We provided theoretical analysis about the optimality of and the conditions of the applicability of the proposed system and other existing methods. We built a simulated system using real game data, showing significant advantages of the proposed matchmaking system in optimizing a chosen engagement metric over existing methods. To our best knowledge, our contribution is the first work which has formally treated matchmaking as an optimization problem to maximize player engagement metrics measured quantitatively. 

% The proposed system has been previously published as "EOMM: An Engagement Optimized Matchmaking Framework", in \textit{Proceedings of the 2017 International Conference on World Wide Web (WWW'17)}~\citep{chen2017eomm}.




\subsection{Dissertation Outline}
The rest of the dissertation will be structured as follows. 
\begin{itemize}
\item Chapter~\ref{chapter:relatework} introduces the background theories, related work as well as gives an introduction to games used in the dissertation research. 
\item Chapter~\ref{chapter:qdeckrec}  details a winning-effective starting item recommendation system,  \textit{Q-DeckRec}, in a one-vs-one CCG. 
\item Chapter~\ref{chapter:draftart} describes a winning-effective character recommendation system, \textit{DraftArtist}, in a team-vs-team MOBA game. They answer 
\hyperref[rq1]{\textbf{R.S.Q. 1}} by experimentally showing that the proposed recommendation system are effective and efficient in search of winning-effective in-game elements. 
\item Chapter~\ref{chapter:eomm} details a data-driven matchmaking framework, \textit{EOMM}, which recommends opponent(s) for each player in order to optimize engagement metrics. It addresses \hyperref[rq2]{\textbf{R.S.Q. 2}} by showing a data-driven approach for improving player engagement directly.

\item Chapter~\ref{chapter:application} discusses application of our proposed systems and Chapter~\ref{chapter:future} discusses limitations and future work.
\item Chapter~\ref{chapter:conclusion} concludes the dissertation and outlines the contributions of the dissertation work.
\end{itemize}



% Player engagement as a complex construct has been analyzed from many different perspectives ~\cite{boyle2012engagement,schoenau2011player,choi2004people,brockmyer2009development}. 


%  \textbf{player competence} is one of the most studied factors which constitute player motivations for playing games~\cite{ryan2006motivational,przybylski2010motivational,yee2006motivations,wu2010falling,sherry2006video,lazzaro2004we,schoenau2011player}. Competence refers to the need for challenge and feelings of being capable and effective. According to Self-Determination theory~\cite{przybylski2010motivational,ryan2006motivational}, competence, together with autonomy and relatedness, drives players as intrinsic motivation to engage in games, where intrinsic motivation means a sense of pleasure and satisfaction beyond external reward such as money~\cite{deci1985intrinsic}. 

% For example, it may pose challenge to inexperienced players for selecting winning-effective characters~\cite{hanke2017reco,summerville2017reco} or items~\cite{garcia2016evolutionary,bjorke2017deckbuilding} from a large number of candidates and recommendation systems could be applied here to offer personalized recommendations on characters and items that help them win with a higher chance.


% revenues by game companies, as nowadays video games have become a highly valuable market worth hundreds of billions of dollars~\cite{today_video_game_market}.

% famous examples include Self-Determination theory~\cite{przybylski2010motivational,ryan2006motivational} which associates players' motives to continue playing with their needs for competence, autonomy and relatedness, and Flow theory~\cite{sweetser2005gameflow,flow1990psychology,chen2007flow} which argues that one important ingredient of player engagement is the optimal match between challenges in the game and their skills.

% In my thesis, I refer a game outcome generally to any possible outcome in a game indicating the player's progress, such as wins, losses, level-ups, and milestones achieved. 

% All these theoretical studies show that monotonous game outcomes such as consecutive losses or wins are not desirable because they indicate consistent over-/under-challenging player experience and raise the importance of carefully maintaining an appropriate sequence of game outcomes for players.

% \footnote{Due to confidential issues, we cannot reveal the title of the game.}


% Churn prediction will serve as an important building component to guide opponent recommendation in our proposed work. Churn prediction has been applied within various disciplines for decades, such as telecommunications \cite{ferreira2004data}, online advertisements \cite{yoon2010prediction} and insurance \cite{morik2004analysing}. Video games have also sparked a number of churn analysis studies. For instance, Weber~et~al. \cite{weber2011modeling} built a regression model to predict the number of games played. They also used the model to aid game design by identifying the most influential features on player retention. Hadiji~et~al. \cite{hadiji2014predicting} established the fundamental in churn prediction in free-to-play (F2P) games by suggesting definitions of various churn behaviors, proposing universal behavioral telemetry, and comparing different machine learning models across five commercial F2P games. Runge~et~al. \cite{runge2014churn} not only trained a churn prediction model for a casual social game but also showed how the game can leverage the model to increase the effectiveness of promotions to players.



% \subsection{Recommendation Systems and Other Adaptive Techniques}

% We note certain interconnectivity between in-game element recommendation systems and other well-known adaptive techniques applied in video games~\cite{bakkes2012personalised,chen2015analytics} which may not be commonly phrased as "recommendation systems". These adaptive techniques include: (1) \textit{Procedural Content Generation} (PCG) for algorithmically generating in-game content tailored to player experience~\cite{yannakakis2011experience,togelius2011search}; and (2) \textit{Dynamic Difficulty Adjustment} (DDA)~\cite{hunicke2005case} and matchmaking~\cite{Delalleau2012,herbrich:trueskill} for identifying human opponents, Non-Player Character (NPC) and game environments suitable for the player's skill. These adaptive techniques are essentially based on some form of prediction on how well the player would accommodate to their adaption. Although the adaption is usually implicitly integrated in the game giving players no options of selecting what specific adaption to receive, I still treat these adaptive techniques as (special cases of) in-game element recommendation systems, because they technically reside in the original definition of recommendation systems as information filtering systems based on prediction of some form of score for user-item pairs~\cite{isinkaye2015recommendation,bobadilla2013recommender,resnick1997recommender,adomavicius2005toward}. 

% The starting item and character recommendation systems we want to focus on in this thesis (see overview in Chapter~\ref{sec:thesis_overview}) do not belong to PCG because starting items and characters to recommend have been generated already in the pre-match stage: our goal is to offer recommendations to ease players' selection on these in-game elements possibly in an overwhelming amount. On the other hand, our opponent recommendation system can be used exactly a matchmaking system. 


% First, starting items, characters and opponents are all commonly seen in-game elements in match-based video games and could have a large impact on today's video game landscape. 

% To influence game outcomes as a means of keeping player engagement, we could dynamically change  This can be achieved by game designers adding heuristics into game design representing their subjective beliefs about what in-game elements are good or bad for player engagement. For instance, certain in-game equipment boosts is designed to be present only in disadvantageous situations to prevent particular players from losing. However, such a method requires heavy domain expertise and lacks scalability and variability. 

% To , an algorithmic alternative for influencing game outcomes is through recommendation systems~\cite{medler2011using}, which provide to players predictions and recommendations of in-game elements adaptive to their personal states (e.g., skills and preferences). Recommendation system techniques originate from web applications, with the aim to ease information overload and retrieve the most relevant information to users for providing personalized services~\cite{isinkaye2015recommendation,bobadilla2013recommender,resnick1997recommender,adomavicius2005toward}. 

% while recommendation systems do not have the access to generate or modify in-game content and only operate on in-game content that the player could make a choice about. For example, an upcoming level in a game could be automatically generated by PCG entailing pre-defined difficulty and themes; however, if the player is not offered to interact with the difficulty and theme configuration of the upcoming level, then there is no recommendation that could be made regarding the upcoming level's content. On the other hand, a recommendation system could recommend to players, for example, suitable play styles~\cite{thue2007interactive,magerko2008intelligent} and skill-competitive human opponents~\cite{Delalleau2012,herbrich:trueskill}, which are not able to be generated by PCG. At the same time, we also acknowledge the interconnectivity between PCG and recommendation systems: technologies used in PCG may be useful to search for optimal recommendations in recommendation systems, or vice versa. 

% Although human-based design and recommendation systems are equally valid ways to influence game outcomes as a means of keeping player engagement, I focus on recommendation systems in this thesis because they can be deployed in a scalable, just-in-time, and on-demand fashion with less design knowledge required. This choice further narrows my research question onto \textit{how can we use recommendation systems to influence game outcomes as a means of keeping players engaged?}

% First, it has always been difficult to access sensitive game data or related software tools for video game research. Through research collaboration and industry internships in the past years, I have spent significant efforts in gathering data and relevant tools which facilitate my research in modeling player and verifying the quality of different recommendation systems. These data and tools, however, could not give me access to generate content in any particular game that I can iteratively test the performance of different PCG algorithms. Second, compared to extensive research in PCG for video games and recommendation systems outside the field of video games, recommendation systems for in-game content in video games have had less attention, indicating much room for improvement. The more detailed motivation for each project is laid out as follows. 

% , where game outcomes become match outcomes restricted to win and lose (and draw if the game allows)



% Based on the number of human player participants, video games can be categorized as single-player and multi-player game. The former puts the single player against pre-programmed challenges or AI-controlled opponents, while the latter allows player interaction with other individuals in partnership, competition or rivalry. Player-versus-Player (PvP) is one mode in which multiple players (who may form as teams) directly engage in competition or combat. PvP games are usually played match after match. 



% In other words, we want to first study leveraging recommendation systems as a \textit{direct} way to influence player competence, yet still an \textit{indirect} way to influence player engagement.


%  Due to the nature of match-based video games, when some players', the other players lose.

% in its serving player population, which should benefit the players' overall engagement as the end goal. 



% When multiple players are in need of our recommendations to improve their player competence or engagement, there must be certain criteria for solving this conflict. In our opponent recommendation system, we choose the criterion as to optimize the overall engagement of the player population, thus it addresses both \textit{how} and \textit{how much} we should influence match outcomes for a population of players. The opponent recommendation is considered as a \textit{direct} means to influence player engagement.


% Starting items are those players designate to bring into a match before the match starts. Starting items have an important impact on player competence because in-match capabilities and strategies could largely depend on the choice of the starting items. Today's video games usually have very rich design to offer players endless replayability. As such, there can be a large number of candidate items to be selected from to build the starting item set and it is often beyond inexperienced players' ability to make good decision for adapting to their situations (e.g., skills and opponents). 

% Each new deck recommendation request will then only need to call the parameterized machine learning model with the input opponent stereotype for obtaining the winning-effective deck without needing to evaluate candidate decks' strength by simulations in real-time.

% Existing solutions for deck recommendation mainly fall into two categories: heuristic searches and metaheuristic searches~\cite{birattari2009tuning}. However they are still insuitable as practical recommendation systems. Heuristic search methods decide which cards to include based on domain heuristics such as popularity and in-game resource curve~\cite{frankkarsten,willfancher,stiegler2016hearthstone}. However, heuristic methods require in-depth human knowledge and lack flexibility to adapt to different opponents. Another category is metaheuristic search, referring to high-level, problem-independent, approximate search strategies for tackling optimization problems~\cite{birattari2009tuning}. An example is to use a \textit{Genetic Algorithm} (GA)~\cite{holland1992adaptation} to evolve decks towards higher winning-effectiveness through repeated modifications and selections~\cite{garcia2016evolutionary,bjorke2017deckbuilding}. Although metaheuristic search algorithms do not require human knowledge to guide searches, they require a large computational cost for each deck recommendation request because: (1) the search process requires a number of evaluations of candidate decks; (2) the evaluation of a candidate deck's quality is computationally expensive, as this requires a large number of simulated matches with complicated in-game rules. 

% Aiming to eliminate the computationally expensive deck evaluation in meta-heuristic methods, my proposed deck recommendation system adds a training phase where a deck building policy is extracted from a large number of deck evaluations. The policy encodes card synergy and opposition relationships into a parameterized machine learning model. Each deck recommendation request will then only need to call the parameterized machine learning model, together with the input opponent stereotype, for obtaining the winning-effective deck. Since the calculation involved in deck building policy requires much cheaper computation resources than deck evaluations, the proposed deck recommendation system is suitable to deploy for large-scale or real-time application, e.g., an online CCG's backend to recommend winning-effective decks to a population of online players, a deck analysis website to serve hundreds of online visitors' deck building requests, or large-scale deck balancing tests. The deck recommendation system exemplifies how we can influence match outcomes positively for one side of a match and how we can locate the winning-optimal start items efficiently for large-scale or real-time application. 


% In certain games, selecting a suitable game character in the pre-match phase is also a key to victory. This is because different characters, like starting items, are designed with various in-game abilities and roles, on which in-game play styles and strategies will largely depend. What we investigate further compared to the starting item recommendation system is on recommending winning-effective characters in the context of \textit{team-based} games, where a large amount of character interactions between teammates or opponents' characters could influence match outcomes~\cite{pobie1,Semenov2016,kim2016proficiency} but often not be comprehended well by inexperienced players.


% Game avatar selection takes place before the match starts. The order of game avatar selection varies across different game modes. In some modes, players select game avatars alternating between the two teams, while in other modes all players can freely choose game avatars within a short time window. Some modes also prohibit from selecting duplicated game avatars. In some modes, certain game avatars can be banned by the other side from being selected. No matter in what game modes players are, game avatar recommendations will be helpful to players' decision making especially for those who already know which game avatars selected by teammates and opponents.

% Game avatars are often designed with a variety of attributes, skills, roles, etc., which is intended to provide players with choices and options so that every player can find a game avatar that fits their preferences. Moreover, it is customary for game avatars in such games to possess strength in one aspect, but weakness in others. For example, in DOTA 2 (Valve Corporation), game avatars with the \textit{Agility} attribute such as \textit{Anti-Mage} excel in long-range physical damage but are susceptible in face-to-face combats. In contrast, with sturdier armor, those of the \textit{Strength} attribute such as \textit{Axe} can tolerate large damage in direct confrontation but lack strong attack ability. As such, in order to win a match, players need to not only control their own game avatars well, but also need to select a game avatar that, together with other team members' picks, forms a team with as few weaknesses as possible, while posing suppressing strengths over those in the opponent team~\cite{kim2016proficiency}.



% Each hero-lineup is associated with a reward, defined as a predicted team win rate representing the estimated strength of the hero line-up. MCTS then back-propagates the reward to update the values of simulated picks. As more simulations are executed, the estimated values become more accurate, allowing MCTS to identify the next pick optimal for team victory. 

% The specific version of MCTS~\cite{kocsis2006bandit} we use, namely Upper Confidence Bound applied to Trees, or UCT, is an \textit{anytime} algorithm, i.e., it has the theoretical guarantee to converge to the optimal pick given sufficient time and memory, while it can be stopped at any time to return an approximate solution. In contrast, previous works either predict player tendency to pick heroes~\cite{summerville2017reco}, or leverage association rules mined from historical hero line-ups as heuristics~\cite{hanke2017reco}. They are not guaranteed to converge to the optimal hero pick for team victory.



% We will show that the long-held belief to always create skill-fair matches for all players is worth revisiting. 


% Currently, the proposed opponent recommendation system work in one-vs-one games but we will show that it can be extended to team-vs-team games if certain component of the system can be further studied and upgraded.  


% Next, we would like to study opponent recommendation to influence match outcomes of a population of pre-match players who are waiting to start matches. In PvP matches, when some players win, the other players lose. We cannot let every player win and enjoy the victory in every match. We choose the criteria of opponent recommendation as to optimize the overall engagement of the pre-match player population. 


% In Table~\ref{tab:churnrate}, we show an example that churn risks vary drastically upon players' recent match outcomes in a real-world popular PvP game. Here, churn risk, a common quantitative measurement of player engagement, is the ratio of the players who stop playing within a period time after a match. These facts lead to three key motivations: (1) it will be good if recommended opponents can complement each other's conscious or subconscious needs to engage in the game; and (2) opponent recommendation should depend on dynamic and individual \emph{player states} besides player skills. Thus, our plan is to develop an opponent recommendation framework that recommend opponents depending on player states in order to optimize the overall engagement, addressing both \textit{how} and \textit{how much} match outcomes should be affected for \textit{a population of players}.


